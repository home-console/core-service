# Plugin System - –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

```
plugin_system/
‚îú‚îÄ‚îÄ __init__.py              # –ü—É–±–ª–∏—á–Ω—ã–π API –º–æ–¥—É–ª—è
‚îú‚îÄ‚îÄ base/                    # –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ base.py             # InternalPluginBase (–∏–∑ SDK)
‚îú‚îÄ‚îÄ managers/                # –ú–µ–Ω–µ–¥–∂–µ—Ä—ã –ø–ª–∞–≥–∏–Ω–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py           # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ dependency.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ lifecycle.py         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ mode.py             # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞–º–∏ —Ä–∞–±–æ—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ security.py         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é
‚îú‚îÄ‚îÄ loader.py                # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤
‚îú‚îÄ‚îÄ registry.py             # –†–µ–µ—Å—Ç—Ä –≤–Ω–µ—à–Ω–∏—Ö –ø–ª–∞–≥–∏–Ω–æ–≤
‚îú‚îÄ‚îÄ metadata_reader.py      # –ß—Ç–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑ plugin.json
‚îú‚îÄ‚îÄ archive_handler.py      # –†–∞–±–æ—Ç–∞ —Å –∞—Ä—Ö–∏–≤–∞–º–∏ (ZIP, TAR.GZ)
‚îú‚îÄ‚îÄ installer.py            # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ router_manager.py       # –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ/—Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ db_manager.py           # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îî‚îÄ‚îÄ plugin_finder.py        # –ü–æ–∏—Å–∫ –ø–ª–∞–≥–∏–Ω–æ–≤ (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –∏ –≤–Ω–µ—à–Ω–∏—Ö)
```

## üéØ –ú–æ–¥—É–ª–∏ –∏ –∏—Ö –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å

### Base (`base/`)
- **base.py**: –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `InternalPluginBase` (–∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ SDK)

### Managers (`managers/`)
- **config.py**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ø–ª–∞–≥–∏–Ω–æ–≤ (–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ —Ñ–∞–π–ª–æ–≤, env, –ë–î)
- **dependency.py**: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É –ø–ª–∞–≥–∏–Ω–∞–º–∏
- **lifecycle.py**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º (–∑–∞–ø—É—Å–∫, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫)
- **mode.py**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞–º–∏ —Ä–∞–±–æ—Ç—ã (in_process, microservice, embedded)
- **security.py**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏
- **loader.py**: –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –ø–ª–∞–≥–∏–Ω–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏
- **registry.py**: –†–µ–µ—Å—Ç—Ä –≤–Ω–µ—à–Ω–∏—Ö HTTP/Docker –ø–ª–∞–≥–∏–Ω–æ–≤
- **metadata_reader.py**: –ß—Ç–µ–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑ `plugin.json`
- **archive_handler.py**: –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∞—Ä—Ö–∏–≤–æ–≤ –ø–ª–∞–≥–∏–Ω–æ–≤ (ZIP, TAR.GZ)
- **installer.py**: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏–∑ `requirements.txt`
- **router_manager.py**: –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ FastAPI —Ä–æ—É—Ç–µ—Ä–æ–≤ –ø–ª–∞–≥–∏–Ω–æ–≤
- **db_manager.py**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–ª–∞–≥–∏–Ω–∞—Ö –≤ –ë–î
- **plugin_finder.py**: –ü–æ–∏—Å–∫ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –∏ –≤–Ω–µ—à–Ω–∏—Ö –ø–ª–∞–≥–∏–Ω–æ–≤

## üì¶ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–± (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```python
from core_service.plugin_system import PluginLoader
from core_service.plugin_system.managers import init_plugin_config_manager
from core_service.plugin_system.registry import external_plugin_registry
```

### –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (–æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
```python
from core_service.plugin_loader import PluginLoader
from core_service.plugin_config import init_plugin_config_manager
from core_service.plugin_registry import external_plugin_registry
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è

–í—Å–µ —Å—Ç–∞—Ä—ã–µ –∏–º–ø–æ—Ä—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–ª–∞–≥–æ–¥–∞—Ä—è —Ñ–∞–π–ª–∞–º –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –≤ –∫–æ—Ä–Ω–µ `core-service/`:
- `plugin_base.py` ‚Üí `plugin_system/core/base.py`
- `plugin_config.py` ‚Üí `plugin_system/managers/config.py`
- `plugin_registry.py` ‚Üí `plugin_system/registry.py`
- –∏ —Ç.–¥.

## ‚ú® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

1. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**: –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é –æ–±–ª–∞—Å—Ç—å
2. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å**: –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
3. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
4. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
5. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –ú–æ–¥—É–ª–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–ë—ã–ª–æ**: 1 –º–æ–Ω—Å—Ç—Ä-—Ñ–∞–π–ª `plugin_loader.py` (1812 —Å—Ç—Ä–æ–∫)
- **–°—Ç–∞–ª–æ**: 17 –º–æ–¥—É–ª–µ–π, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤ –ª–æ–≥–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
- **–†–∞–∑–º–µ—Ä**: ~1632 —Å—Ç—Ä–æ–∫–∏ (–Ω–∞ 10% –º–µ–Ω—å—à–µ, –Ω–æ –Ω–∞–º–Ω–æ–≥–æ –ø–æ–Ω—è—Ç–Ω–µ–µ)

